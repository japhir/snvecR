<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="snvecR">
<title>Analyze a grid of Td and Ed values • snvecR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyze a grid of Td and Ed values">
<meta property="og:description" content="snvecR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">snvecR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.7.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyze_grid_td-ed.html">Analyze a grid of Td and Ed values</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Analyze a grid of Td and Ed values</h1>
            
      
      
      <div class="d-none name"><code>analyze_grid_td-ed.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>  <span class="co"># nice dataframes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>   <span class="co"># mutate/select/filter/glimpse</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span>   <span class="co"># pmap</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>   <span class="co"># unnest</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># nice plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://japhir.github.io/snvecR/">snvecR</a></span><span class="op">)</span>  <span class="co"># this package</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The function <code><a href="../reference/snvec.html">snvec()</a></code> uses some of the parameters of a
full orbital solution (OS) such as ZB18a from Zeebe and Lourens (2019)
in combination with values for tidal dissipation (T<sub>d</sub>) and
dynamical ellipticity (E<sub>d</sub>) to calculate precession and
obliquity (or tilt).</p>
<p>In this vignette we show how we would go about using
<code><a href="../reference/snvec.html">snvec()</a></code> for a range of input values.</p>
</div>
<div class="section level2">
<h2 id="create-a-grid-of-td-and-ed">Create a grid of T<sub>d</sub> and E<sub>d</sub><a class="anchor" aria-label="anchor" href="#create-a-grid-of-td-and-ed"></a>
</h2>
<p>We create a grid of input values for T<sub>d</sub> and E<sub>d</sub>.
The values in the grid are based on Zeebe and Lourens (2022) table
2.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Td <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>              Ed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.000</span>, <span class="fl">0.998</span>, <span class="fl">1.005</span>, <span class="fl">1.012</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="co"># that's 32 rows</span></span>
<span><span class="va">biggrid</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 2</span></span></span>
<span><span class="co">#&gt;       Td    Ed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0   1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   0.7 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   0.8 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   0.9 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   1   1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   1.1 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   1.2 1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   0   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   0.5 0.998</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 22 more rows</span></span></span></code></pre></div>
<p>We now add columns for important parameter values that do not vary
between experiments, so that it is very clear from the output what the
inputs were.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">&lt;-</span> <span class="va">biggrid</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># for now only for 1000 years at very high tolerance so it's fast</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>atol <span class="op">=</span> <span class="fl">1e-4</span>, tend <span class="op">=</span> <span class="op">-</span><span class="fl">1e3</span><span class="op">)</span></span>
<span>    <span class="co"># this would be the real deal, the full 100--0 Ma results at medium</span></span>
<span>    <span class="co"># tolerance.</span></span>
<span>    <span class="co">## mutate(tol = 1e-7, tend = -1e5)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-a-new-list-column-with-the-results">Calculate a new list-column with the results<a class="anchor" aria-label="anchor" href="#calculate-a-new-list-column-with-the-results"></a>
</h2>
<p>We’re going to use <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">purrr::pmap()</a></code> here, which allows you
to apply a function given a list of input values. We use it here to
create a list-column with the results.</p>
<p>This is some advanced R stuff, so feel free to read up on it if you
want in Wickham et al., (2023). In particular, see <a href="https://r4ds.had.co.nz/iteration.html#mapping-over-multiple-arguments" class="external-link">the
chapter on iteration</a> for the basics, and <a href="https://r4ds.had.co.nz/many-models.html" class="external-link">many models</a> for the
full approach.</p>
<p>If we would apply the <code><a href="../reference/snvec.html">snvec()</a></code> function here directly for
the full 100 Myr, it would quickly make R run out of memory, because it
would be storing all the timesteps for those 32 experiments. Instead, we
write a wrapper function that only stores the latest N timesteps.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">snvec_tail</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># do the fit with the parameters in ...</span></span>
<span>  <span class="fu"><a href="../reference/snvec.html">snvec</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># save only the last n values, that's where the differences are greatest</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Compute obliquity and precession for each parameter combination, and
save it in the new list-column <code>sol</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">&lt;-</span> <span class="va">biggrid</span> <span class="op">|&gt;</span></span>
<span>    <span class="co"># apply our new function!</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sol <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>td <span class="op">=</span> <span class="va">Td</span>, ed <span class="op">=</span> <span class="va">Ed</span>, tend <span class="op">=</span> <span class="va">tend</span>, atol <span class="op">=</span> <span class="va">atol</span><span class="op">)</span>,</span>
<span>                      .f <span class="op">=</span> <span class="va">snvec_tail</span>,</span>
<span>                      <span class="co"># additional parameters to snvec_tail can go after!</span></span>
<span>                      quiet <span class="op">=</span> <span class="cn">TRUE</span>, output <span class="op">=</span> <span class="st">"nice"</span>, n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                      <span class="co"># I would strongly recommend against increasing the</span></span>
<span>                      <span class="co"># resolution too much, but for speed/illustration we</span></span>
<span>                      <span class="co"># prefer to do it here</span></span>
<span>                      tres <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                      <span class="co"># interactively this makes a nice progress bar</span></span>
<span>                      .progress <span class="op">=</span> <span class="st">"snvec on a grid"</span><span class="op">)</span><span class="op">)</span> <span class="co">#|&gt;</span></span>
<span><span class="co">#&gt; snvec on a grid <span style="color: #00BB00;">■■■                             </span>   6% |  ETA: 15s</span></span>
<span><span class="co">#&gt; snvec on a grid <span style="color: #00BB00;">■■■■■■■■■                       </span>  28% |  ETA: 10s</span></span>
<span><span class="co">#&gt; snvec on a grid <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% |  ETA:  7s</span></span>
<span><span class="co">#&gt; snvec on a grid <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■         </span>  75% |  ETA:  3s</span></span>
<span><span class="co">#&gt; snvec on a grid <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  </span>  97% |  ETA:  0s</span></span>
<span></span>
<span>    <span class="co"># normally we would save the results to file, because these take quite a</span></span>
<span>    <span class="co"># long time to calculate and we don't want to accidentally delete them.</span></span>
<span>    <span class="co">## write_rds("out/2023-04-05_biggrid.rds")</span></span></code></pre></div>
<p>This would be how I would read in my old results (about 9MB on-disk
for the final 1000 timesteps in the full 100 Myr simulations).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"out/2023-04-05_biggrid.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="inspect-results">Inspect results<a class="anchor" aria-label="anchor" href="#inspect-results"></a>
</h2>
<p>Let’s look at the structure of the output:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">biggrid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 32</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ Td   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0, 0.5, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 0.0, 0.5, 0.7, 0.8, 0.9, …</span></span>
<span><span class="co">#&gt; $ Ed   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 0.998, 0.…</span></span>
<span><span class="co">#&gt; $ atol <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1e-04, 1e-04, 1e-04, 1e-04, 1e-04, 1e-04, 1e-04, 1e-04, 1e-04, 1e…</span></span>
<span><span class="co">#&gt; $ tend <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1000, -1000, -1000, -1000, -1000, -1000, -1000, -1000, -1000, -1…</span></span>
<span><span class="co">#&gt; $ sol  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [&lt;tbl_df[100 x 6]&gt;], [&lt;tbl_df[100 x 6]&gt;], [&lt;tbl_df[100 x 6]&gt;], […</span></span></code></pre></div>
<p>We can see the list column <code>sol</code> in this result! But we’d
like to access the raw output, so we use <code><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expanded</span> <span class="op">&lt;-</span> <span class="va">biggrid</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span>
<span><span class="va">expanded</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,200 × 10</span></span></span>
<span><span class="co">#&gt;       Td    Ed   atol  tend       time   age    eei   epl     phi       cp</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">184</span><span style="color: #BB0000; text-decoration: underline;">451</span><span style="color: #BB0000;">250</span>   505 0.031<span style="text-decoration: underline;">9</span> 0.407 -<span style="color: #BB0000;">2.21</span>   -<span style="color: #BB0000;">0.029</span><span style="color: #BB0000; text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">186</span><span style="color: #BB0000; text-decoration: underline;">277</span><span style="color: #BB0000;">500</span>   510 0.029<span style="text-decoration: underline;">0</span> 0.399 -<span style="color: #BB0000;">0.978</span>  -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">188</span><span style="color: #BB0000; text-decoration: underline;">103</span><span style="color: #BB0000;">750</span>   515 0.025<span style="text-decoration: underline;">4</span> 0.395  0.269   0.021<span style="text-decoration: underline;">4</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">189</span><span style="color: #BB0000; text-decoration: underline;">930</span><span style="color: #BB0000;">000</span>   520 0.021<span style="text-decoration: underline;">2</span> 0.398  1.52    0.013<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">191</span><span style="color: #BB0000; text-decoration: underline;">756</span><span style="color: #BB0000;">250</span>   525 0.016<span style="text-decoration: underline;">9</span> 0.406  2.76   -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">69</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">193</span><span style="color: #BB0000; text-decoration: underline;">582</span><span style="color: #BB0000;">500</span>   530 0.013<span style="text-decoration: underline;">5</span> 0.416 -<span style="color: #BB0000;">2.31</span>   -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">195</span><span style="color: #BB0000; text-decoration: underline;">408</span><span style="color: #BB0000;">750</span>   535 0.012<span style="text-decoration: underline;">1</span> 0.422 -<span style="color: #BB0000;">1.12</span>   -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">40</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">197</span><span style="color: #BB0000; text-decoration: underline;">235</span><span style="color: #BB0000;">000</span>   540 0.013<span style="text-decoration: underline;">6</span> 0.420  0.069<span style="text-decoration: underline;">6</span>  0.007<span style="text-decoration: underline;">89</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">199</span><span style="color: #BB0000; text-decoration: underline;">061</span><span style="color: #BB0000;">250</span>   545 0.017<span style="text-decoration: underline;">1</span> 0.410  1.27    0.016<span style="text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     0     1 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> -<span style="color: #BB0000;">200</span><span style="color: #BB0000; text-decoration: underline;">887</span><span style="color: #BB0000;">500</span>   550 0.021<span style="text-decoration: underline;">4</span> 0.399  2.50    0.001<span style="text-decoration: underline;">57</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,190 more rows</span></span></span></code></pre></div>
<p>Let’s make a figure of these final values.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expanded</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">cp</span>,</span>
<span>             colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Td</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Ed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age (ka)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Climatic precession"</span>,</span>
<span>       colour <span class="op">=</span> <span class="st">"Tidal dissipation"</span>,</span>
<span>       linetype <span class="op">=</span> <span class="st">"Dynamical ellipticity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># make panels of plots</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">Td</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add eccentricity</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">eei</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_grid_td-ed_files/figure-html/plot-1.png" width="1152"></p>
<p>Now the analysis can begin!</p>
</div>
<div class="section level2">
<h2 id="alternatively-save-the-results-for-each-row-to-file-instead">Alternatively: save the results for each row to file instead<a class="anchor" aria-label="anchor" href="#alternatively-save-the-results-for-each-row-to-file-instead"></a>
</h2>
<p>If we care about the full outputs of each of the simulations, the
above approach will likely make you run out of memory (crash R). One way
to deal with this is to write each simulation to a file. We create a
filename from the variables and then use <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">purrr::pwalk()</a></code> in
stead of <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap()</a></code>.</p>
<p>This could look like this:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">&lt;-</span> <span class="va">biggrid</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># get rid of sol column</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">sol</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># add a filename that's easy to break into relevant parameters later</span></span>
<span>  <span class="co"># I write to tempdir here, but you might want to write to something like out/</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{tempdir()}/2023-04-13_biggrid_{Td}_{Ed}_{atol}_{tend}.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">biggrid</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 5</span></span></span>
<span><span class="co">#&gt;       Td    Ed   atol  tend file                                                </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;glue&gt;</span>                                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0   1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0_1_1e-04_-1000.…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5 1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0.5_1_1e-04_-100…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   0.7 1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0.7_1_1e-04_-100…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   0.8 1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0.8_1_1e-04_-100…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   0.9 1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0.9_1_1e-04_-100…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   1   1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_1_1_1e-04_-1000.…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   1.1 1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_1.1_1_1e-04_-100…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   1.2 1     0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_1.2_1_1e-04_-100…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   0   0.998 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0_0.998_1e-04_-1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   0.5 0.998 0.000<span style="text-decoration: underline;">1</span> -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> /tmp/RtmpvRP9ND/2023-04-13_biggrid_0.5_0.998_1e-04_…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 22 more rows</span></span></span></code></pre></div>
<p>We write a new wrapper function that includes a file argument to save
the outputs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">snvec_save</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/snvec.html">snvec</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">write_rds</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_inform</a></span><span class="op">(</span><span class="st">"Wrote file {.file {file}}."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Calculate each time series’ obliquity and precession and save to
file.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># in this case we make sure that column names are identical to argument names</span></span>
<span>  <span class="co"># so that the list (in this case tibble/data.frame) is matched to the correct</span></span>
<span>  <span class="co"># arguments</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>td <span class="op">=</span> <span class="va">Td</span>, ed <span class="op">=</span> <span class="va">Ed</span>, atol <span class="op">=</span> <span class="va">atol</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pwalk</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">snvec_save</span>,</span>
<span>               <span class="co"># additional parameters can go after!</span></span>
<span>               quiet <span class="op">=</span> <span class="cn">TRUE</span>, output <span class="op">=</span> <span class="st">"nice"</span>, tres <span class="op">=</span> <span class="fl">5</span>,</span>
<span>               <span class="co"># show progress bar</span></span>
<span>               .progress <span class="op">=</span> <span class="st">"snvec to file"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.5_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.7_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.8_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.9_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; snvec to file <span style="color: #00BB00;">■■■■■■                          </span>  16% |  ETA: 12s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.1_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.2_1_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.5_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.7_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.8_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; snvec to file <span style="color: #00BB00;">■■■■■■■■■■■■                    </span>  38% |  ETA:  9s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.9_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.1_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.2_0.998_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.5_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.7_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; snvec to file <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■             </span>  59% |  ETA:  6s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.8_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.9_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.1_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.2_1.005_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; snvec to file <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■        </span>  78% |  ETA:  3s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.5_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.7_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.8_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_0.9_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.1_1.012_1e-04_-1000.rds</span>.</span></span>
<span><span class="co">#&gt; Wrote file <span style="color: #0000BB;">/tmp/RtmpvRP9ND/2023-04-13_biggrid_1.2_1.012_1e-04_-1000.rds</span>.</span></span></code></pre></div>
<p>This would lead to the creation of one file per row, which you can
read in individually or for a certain subset using
<code><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">readr::read_rds()</a></code>.</p>
<p>Below we do it for all the files and make a plot!</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biggrid</span> <span class="op">|&gt;</span> <span class="co"># limit to a few experiments</span></span>
<span>  <span class="co">## slice(c(1, 15, 32)) |&gt;</span></span>
<span>  <span class="co"># in this case that's not necessary because we limited it to a very</span></span>
<span>  <span class="co"># low-resolution (tres) and short time period (tend)</span></span>
<span>  <span class="co"># read them in to list-column</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>fullsol <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="fu">readr</span><span class="fu">::</span><span class="va"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># unfold the list column</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">fullsol</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># plot the obliquity</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">epl</span>,</span>
<span>             colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Td</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Ed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age (ka)"</span>, y <span class="op">=</span> <span class="st">"Obliquity"</span>,</span>
<span>       colour <span class="op">=</span> <span class="st">"Tidal dissipation"</span>,</span>
<span>       linetype <span class="op">=</span> <span class="st">"Dynamical ellipticity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">## facet_grid(rows = vars(Td)) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyze_grid_td-ed_files/figure-html/read-files-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612" class="external-link">doi:10.1126/science.aax0612</a>.</p>
<p>Zeebe, R. E., &amp; Lourens, L. J. (2022). A deep-time dating tool
for paleo-applications utilizing obliquity and precession cycles: The
role of dynamical ellipticity and tidal dissipation.
<em>Paleoceanography and Paleoclimatology</em>, e2021PA004349. <a href="https://doi.org/10.1029/2021PA004349" class="external-link">doi:10.1029/2021PA004349</a>.</p>
<p>Zeebe, R. E. (2022). Reduced Variations in Earth’s and Mars’ Orbital
Inclination and Earth’s Obliquity from 58 to 48 Myr ago due to Solar
System Chaos. <em>The Astronomical Journal</em>, 164(3), 107. <a href="https://doi.org/10.3847/1538-3881/ac80f8" class="external-link">doi:10.3847/1538-3881/ac80f8</a>.</p>
<p>Wikipedia page on Orbital Elements: <a href="https://en.wikipedia.org/wiki/Orbital_elements" class="external-link uri">https://en.wikipedia.org/wiki/Orbital_elements</a></p>
<p>Wickham, H., Çetinkaya-Rundel, M., &amp; Grolemund, G. (2023). R for
Data Science: Import, Tidy, Transform, Visualize, and Model Data (2nd
edition). O’Reilly Media. <a href="https://r4ds.hadley.nz" class="external-link uri">https://r4ds.hadley.nz</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ilja Kocken, Richard Zeebe.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
